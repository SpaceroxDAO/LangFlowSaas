# Teach Charlie AI - Environment Variables
# Copy this file to .env and fill in your actual values
# NEVER commit .env to git (it's in .gitignore)

# =============================================================================
# PRODUCTION SECURITY CHECKLIST
# =============================================================================
# Before deploying to production, ensure ALL of these are set:
#
# 1. ENVIRONMENT=production (enables security safeguards)
# 2. DEV_MODE=false (CRITICAL - enables authentication)
# 3. ENCRYPTION_KEY=<generate-secure-key> (for API key encryption)
# 4. LANGFLOW_SECRET_KEY=<32-char-random-string> (session security)
# 5. CLERK_*=<production-keys> (use pk_live_, sk_live_ - NOT pk_test_)
# 6. DATABASE_URL=<production-database> (NOT localhost)
# 7. CORS_ORIGINS=https://yourdomain.com (NOT *)
# 8. SENTRY_DSN=<your-dsn> (for error monitoring)
#
# Generate secure keys:
#   ENCRYPTION_KEY: python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
#   LANGFLOW_SECRET_KEY: openssl rand -base64 32
#   LANGFLOW_API_KEY: openssl rand -hex 16
# =============================================================================

# ============================================================================
# GENERAL
# ============================================================================

# Environment name - CRITICAL FOR SECURITY
# Set to "production" or "staging" in production deployments
# This enables security safeguards that block DEV_MODE
# Valid values: development, staging, production
ENVIRONMENT=development

# Node environment (for frontend)
NODE_ENV=development

# Application URL (used for CORS, redirects, etc.)
APP_URL=http://localhost:3000

# API Base URL (backend)
API_URL=http://localhost:7860

# ============================================================================
# DATABASE (PostgreSQL + pgvector)
# ============================================================================

# PostgreSQL connection string
# Format: postgresql://username:password@host:port/database
# Local: postgresql://postgres:postgres@localhost:5432/teachcharlie
# DataStax: Get from DataStax dashboard
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/teachcharlie

# Database pool settings (optional)
DB_POOL_MIN=2
DB_POOL_MAX=10

# ============================================================================
# AUTHENTICATION (Clerk)
# ============================================================================

# Clerk Publishable Key (safe to expose in frontend)
# Get from: https://dashboard.clerk.com/
NEXT_PUBLIC_CLERK_PUBLISHABLE_KEY=pk_test_xxxxxxxxxxxxxxxxxxxxx

# Clerk Secret Key (NEVER expose in frontend, backend only)
CLERK_SECRET_KEY=sk_test_xxxxxxxxxxxxxxxxxxxxx

# Clerk Frontend API (for client-side auth)
NEXT_PUBLIC_CLERK_FRONTEND_API=clerk.xxxxx.lcl.dev

# Clerk API URL
CLERK_API_URL=https://api.clerk.dev/v1

# ============================================================================
# LLM PROVIDERS
# ============================================================================

# OpenAI API Key (for GPT models)
# Get from: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxx

# Anthropic API Key (for Claude models)
# Get from: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-xxxxxxxxxxxxxxxxxxxxx

# Default LLM provider (openai, anthropic, etc.)
DEFAULT_LLM_PROVIDER=openai

# Default model (gpt-3.5-turbo, gpt-4, claude-3-sonnet-20240229, etc.)
DEFAULT_LLM_MODEL=gpt-3.5-turbo

# LLM temperature (0.0 - 1.0, higher = more creative)
DEFAULT_LLM_TEMPERATURE=0.7

# ============================================================================
# COMPOSIO INTEGRATION (OAuth for 500+ Apps)
# ============================================================================

# Composio API Key
# Get from: https://app.composio.dev/settings
# Enables Gmail, Calendar, Slack, HubSpot, Notion, and 500+ other integrations
COMPOSIO_API_KEY=ak_xxxxxxxxxxxxxxxxxxxxx

# OAuth Callback URL (where users return after connecting apps)
# Local dev: http://localhost:3001/settings/connections/callback
# Production: https://app.teachcharlie.ai/settings/connections/callback
COMPOSIO_CALLBACK_URL=http://localhost:3001/settings/connections/callback

# ============================================================================
# LANGFLOW CONFIGURATION
# ============================================================================

# Langflow host and port (internal service)
LANGFLOW_HOST=localhost
LANGFLOW_PORT=7860

# Langflow API URL (backend-to-Langflow communication)
# Local dev: http://localhost:7860
# Docker: http://langflow:7860 (uses Docker service name)
LANGFLOW_API_URL=http://localhost:7860

# Docker container name for Langflow (used for restart functionality)
# MUST match container_name in docker-compose.yml
LANGFLOW_CONTAINER_NAME=teachcharlie-langflow

# Frontend Langflow URL (for iframe embedding)
# IMPORTANT: Use FULL URL with port - Langflow doesn't support subpath deployment
#
# ALWAYS use port 7861 (nginx) for CSS injection/white-label overlay
# The nginx proxy injects CSS/JS to hide Langflow UI elements
#
# LOCAL DEV: docker-compose -f docker-compose.dev.yml up -d
#   This runs postgres, langflow, and nginx (for langflow proxy only)
#   Frontend/backend run on host machine
#
# PRODUCTION: docker-compose up -d (full stack in Docker)
#
# Default is http://localhost:7861 - only override if using different port
# VITE_LANGFLOW_URL=http://localhost:7861

# Langflow database URL (same as DATABASE_URL above)
LANGFLOW_DATABASE_URL=${DATABASE_URL}

# Langflow secret key (for session management)
LANGFLOW_SECRET_KEY=your-secret-key-here

# Langflow auto-login (development only, set to false in production)
LANGFLOW_AUTO_LOGIN=false

# ============================================================================
# CACHING & SESSIONS (Optional - Phase 2)
# ============================================================================

# Redis URL (for session management and caching)
# Format: redis://username:password@host:port/database
# REDIS_URL=redis://localhost:6379/0

# Session secret (for encrypting cookies)
SESSION_SECRET=your-session-secret-here

# ============================================================================
# EMAIL (SendGrid or Resend) - Phase 2
# ============================================================================

# Email provider (sendgrid, resend)
# EMAIL_PROVIDER=sendgrid

# SendGrid API Key
# Get from: https://app.sendgrid.com/settings/api_keys
# SENDGRID_API_KEY=SG.xxxxxxxxxxxxxxxxxxxxx

# Resend API Key
# Get from: https://resend.com/api-keys
# RESEND_API_KEY=re_xxxxxxxxxxxxxxxxxxxxx

# From email address
# FROM_EMAIL=noreply@teachcharlie.ai

# ============================================================================
# PAYMENTS (Stripe) - Phase 2
# ============================================================================

# Stripe Publishable Key (safe to expose in frontend)
# Get from: https://dashboard.stripe.com/apikeys
# NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_xxxxxxxxxxxxxxxxxxxxx

# Stripe Secret Key (NEVER expose, backend only)
# STRIPE_SECRET_KEY=sk_test_xxxxxxxxxxxxxxxxxxxxx

# Stripe Webhook Secret (for webhook signature verification)
# STRIPE_WEBHOOK_SECRET=whsec_xxxxxxxxxxxxxxxxxxxxx

# ============================================================================
# ANALYTICS & MONITORING - Phase 2
# ============================================================================

# PostHog API Key (for user analytics)
# Get from: https://app.posthog.com/project/settings
# NEXT_PUBLIC_POSTHOG_KEY=phc_xxxxxxxxxxxxxxxxxxxxx
# NEXT_PUBLIC_POSTHOG_HOST=https://app.posthog.com

# Mixpanel Token
# Get from: https://mixpanel.com/settings/project
# NEXT_PUBLIC_MIXPANEL_TOKEN=xxxxxxxxxxxxxxxxxxxxx

# Sentry DSN (for error tracking)
# Get from: https://sentry.io/settings/projects/
# SENTRY_DSN=https://xxxxxxxxxxxxxxxxxxxxx@sentry.io/xxxxx

# ============================================================================
# SECURITY & RATE LIMITING
# ============================================================================

# Encryption Key (for encrypting API keys and credentials in database)
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# IMPORTANT: Keep this secret! If you lose it, encrypted data cannot be recovered.
ENCRYPTION_KEY=your-encryption-key-here

# JWT Secret (for API authentication)
JWT_SECRET=your-jwt-secret-here

# JWT Expiration (e.g., 1h, 24h, 7d)
JWT_EXPIRATION=24h

# Rate limit (requests per minute per user)
RATE_LIMIT_PER_MINUTE=100

# Max agent messages per day (free tier)
MAX_MESSAGES_PER_DAY_FREE=100

# Max agents per user (free tier)
MAX_AGENTS_FREE=3

# ============================================================================
# FEATURE FLAGS (Optional)
# ============================================================================

# Enable/disable features for testing
FEATURE_MULTI_TENANCY=false
FEATURE_TEMPLATE_LIBRARY=false
FEATURE_ANALYTICS_DASHBOARD=false
FEATURE_EMBEDDABLE_WIDGET=false
FEATURE_INTEGRATIONS=false

# ============================================================================
# LOGGING & DEBUGGING
# ============================================================================

# Log level (debug, info, warn, error)
LOG_LEVEL=info

# Enable debug mode (shows detailed logs)
DEBUG=false

# ============================================================================
# DEPLOYMENT (DataStax / Docker)
# ============================================================================

# Docker Compose profile (development, production)
COMPOSE_PROFILES=development

# Host machine port for frontend
FRONTEND_PORT=3000

# Host machine port for backend (Langflow)
BACKEND_PORT=7860

# Host machine port for PostgreSQL
POSTGRES_PORT=5432

# ============================================================================
# DEVELOPMENT ONLY
# ============================================================================

# Disable HTTPS requirement (local development only)
DISABLE_HTTPS=true

# CORS allowed origins (comma-separated)
# Development: http://localhost:3000,http://localhost:3001,http://localhost:5173
# Production: https://teachcharlie.ai,https://www.teachcharlie.ai,https://app.teachcharlie.ai
CORS_ORIGINS=http://localhost:3000,http://localhost:3001,http://localhost:5173

# Skip email verification (development only)
SKIP_EMAIL_VERIFICATION=true

# Development Mode - bypasses Clerk authentication entirely
# Set to true for frontend/backend development without auth friction
# Backend: DEV_MODE=true (returns mock user for all requests)
# Frontend: VITE_DEV_MODE=true (skips Clerk provider, shows dev banner)
# WARNING: NEVER enable in production - all auth checks are disabled!
DEV_MODE=false
# VITE_DEV_MODE=false  # Set in src/frontend/.env

# ============================================================================
# NOTES
# ============================================================================

# 1. Copy this file to .env: cp .env.example .env
# 2. Fill in your actual API keys and secrets
# 3. NEVER commit .env to git
# 4. For production, use environment variables from DataStax/cloud provider
# 5. Rotate secrets regularly (every 90 days minimum)
# 6. Use strong, random values for secret keys (generate with: openssl rand -base64 32)
