# =============================================================================
# Teach Charlie AI - PRODUCTION Environment Variables
# =============================================================================
#
# INSTRUCTIONS:
# 1. Copy this file to .env.production
# 2. Fill in ALL values (no defaults are safe for production)
# 3. Generate secure keys using the commands below
# 4. NEVER commit .env.production to git
#
# GENERATE SECURE KEYS:
#   ENCRYPTION_KEY:      python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
#   LANGFLOW_SECRET_KEY: openssl rand -base64 32
#   LANGFLOW_API_KEY:    openssl rand -hex 16
#   SESSION_SECRET:      openssl rand -base64 32
#
# =============================================================================

# =============================================================================
# ENVIRONMENT (CRITICAL)
# =============================================================================

# Must be "production" - enables security safeguards
ENVIRONMENT=production

# Must be "false" - enables authentication
DEV_MODE=false

# Debug mode - must be false in production
DEBUG=false

# =============================================================================
# DATABASE (PostgreSQL)
# =============================================================================

# Production database connection string
# Use a managed PostgreSQL service (Supabase, Neon, AWS RDS, etc.)
# Format: postgresql://user:password@host:port/database?sslmode=require
DATABASE_URL=postgresql://postgres:STRONG_PASSWORD_HERE@your-db-host.com:5432/teachcharlie?sslmode=require

# PostgreSQL credentials (for docker-compose)
POSTGRES_USER=postgres
POSTGRES_PASSWORD=GENERATE_STRONG_PASSWORD_HERE
POSTGRES_DB=teachcharlie

# =============================================================================
# ENCRYPTION & SECURITY (REQUIRED)
# =============================================================================

# Fernet encryption key for user API keys
# Generate: python3 -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# WARNING: If you lose this key, encrypted user API keys cannot be recovered!
ENCRYPTION_KEY=GENERATE_AND_PASTE_HERE

# Session secret for cookies
# Generate: openssl rand -base64 32
SESSION_SECRET=GENERATE_AND_PASTE_HERE

# =============================================================================
# AUTHENTICATION (Clerk - PRODUCTION KEYS)
# =============================================================================

# Get PRODUCTION keys from: https://dashboard.clerk.com/
# Must use pk_live_ and sk_live_ prefixes (NOT pk_test_/sk_test_)

CLERK_PUBLISHABLE_KEY=pk_live_xxxxxxxxxxxxxxxxxxxx
CLERK_SECRET_KEY=sk_live_xxxxxxxxxxxxxxxxxxxx

# Your Clerk instance URLs
CLERK_ISSUER=https://your-instance.clerk.accounts.dev
CLERK_JWKS_URL=https://your-instance.clerk.accounts.dev/.well-known/jwks.json

# Allowed origins for Clerk tokens (your production domain)
CLERK_AUTHORIZED_PARTIES=https://teachcharlie.ai,https://www.teachcharlie.ai,https://app.teachcharlie.ai

# =============================================================================
# LANGFLOW CONFIGURATION
# =============================================================================

# Internal URL (Docker service name)
LANGFLOW_API_URL=http://langflow:7860

# Container name (must match docker-compose.prod.yml)
LANGFLOW_CONTAINER_NAME=teachcharlie-langflow

# Secret key for Langflow sessions
# Generate: openssl rand -base64 32
LANGFLOW_SECRET_KEY=GENERATE_AND_PASTE_HERE

# API key for backend-to-Langflow communication
# Generate: openssl rand -hex 16
LANGFLOW_API_KEY=GENERATE_AND_PASTE_HERE

# Number of Langflow workers (adjust based on server resources)
LANGFLOW_WORKERS=2

# =============================================================================
# LLM API KEYS (Optional - users provide their own)
# =============================================================================

# Only set these if you want to provide default/fallback keys
# Most users will configure their own keys in Settings

# OPENAI_API_KEY=sk-xxxxxxxxxxxxxxxxxxxx
# ANTHROPIC_API_KEY=sk-ant-xxxxxxxxxxxxxxxxxxxx

# =============================================================================
# COMPOSIO (OAuth Integrations)
# =============================================================================

# Get from: https://app.composio.dev/settings
COMPOSIO_API_KEY=ak_xxxxxxxxxxxxxxxxxxxx

# OAuth callback URL (your production domain)
COMPOSIO_CALLBACK_URL=https://app.teachcharlie.ai/settings/connections/callback

# =============================================================================
# REDIS (Rate Limiting & Caching)
# =============================================================================

# Redis connection string
# Use a managed Redis service or include in docker-compose
REDIS_URL=redis://redis:6379

# Optional: Redis password
# REDIS_PASSWORD=STRONG_PASSWORD_HERE

# =============================================================================
# CORS (CRITICAL - Restrict to your domains)
# =============================================================================

# Comma-separated list of allowed origins
# Only include YOUR production domains
CORS_ORIGINS=https://teachcharlie.ai,https://www.teachcharlie.ai,https://app.teachcharlie.ai

# =============================================================================
# SENTRY (Error Monitoring - HIGHLY RECOMMENDED)
# =============================================================================

# Get from: https://sentry.io/settings/projects/
# Create separate projects for frontend and backend

# Backend Sentry DSN
SENTRY_DSN=https://xxxxxxxxxxxx@o123456.ingest.sentry.io/1234567

# Frontend Sentry DSN (same or different project)
VITE_SENTRY_DSN=https://xxxxxxxxxxxx@o123456.ingest.sentry.io/1234567

# Environment tag for Sentry
SENTRY_ENVIRONMENT=production

# Trace sample rate (0.0 to 1.0)
# 0.1 = 10% of transactions, good for production
SENTRY_TRACES_SAMPLE_RATE=0.1

# =============================================================================
# STRIPE (Billing - When Ready)
# =============================================================================

# Get PRODUCTION keys from: https://dashboard.stripe.com/apikeys
# Must use pk_live_ and sk_live_ prefixes

# STRIPE_PUBLISHABLE_KEY=pk_live_xxxxxxxxxxxxxxxxxxxx
# STRIPE_SECRET_KEY=sk_live_xxxxxxxxxxxxxxxxxxxx
# STRIPE_WEBHOOK_SECRET=whsec_xxxxxxxxxxxxxxxxxxxx
# STRIPE_PRO_PRICE_ID=price_xxxxxxxxxxxxxxxxxxxx
# STRIPE_TEAM_PRICE_ID=price_xxxxxxxxxxxxxxxxxxxx

# =============================================================================
# APPLICATION URLS
# =============================================================================

# Your production domain
APP_URL=https://teachcharlie.ai

# API URL (usually same domain with /api prefix)
API_URL=https://teachcharlie.ai/api

# =============================================================================
# RATE LIMITING
# =============================================================================

# Requests per minute per user
RATE_LIMIT_PER_MINUTE=60

# Requests per hour per user
RATE_LIMIT_PER_HOUR=1000

# =============================================================================
# DEPLOYMENT CHECKLIST
# =============================================================================
#
# Before deploying, verify:
#
# [ ] ENVIRONMENT=production
# [ ] DEV_MODE=false
# [ ] DEBUG=false
# [ ] All *_SECRET_KEY variables are unique, random strings
# [ ] ENCRYPTION_KEY is generated and backed up securely
# [ ] Clerk keys are pk_live_/sk_live_ (not test keys)
# [ ] DATABASE_URL uses SSL (sslmode=require)
# [ ] CORS_ORIGINS only includes your domains
# [ ] SENTRY_DSN is configured
# [ ] SSL certificate is configured in nginx
# [ ] Database backups are configured
# [ ] Monitoring/alerting is set up
#
# =============================================================================
